import win32com.client
import os

def convert_word_to_pdf(docx_path, pdf_path):
    word = win32com.client.Dispatch("Word.Application")
    word.Visible = False

    doc = word.Documents.Open(docx_path)
    doc.ExportAsFixedFormat(pdf_path, ExportFormat=17)  # 17 = PDF
    doc.Close()
    word.Quit()

# 예시 실행
convert_word_to_pdf(r"C:\docs\test.docx", r"C:\docs\test.pdf")

def convert_excel_to_pdf(xlsx_path, pdf_path):
    excel = win32com.client.Dispatch("Excel.Application")
    excel.Visible = False

    workbook = excel.Workbooks.Open(xlsx_path)
    workbook.ExportAsFixedFormat(0, pdf_path)  # 0 = PDF
    workbook.Close(False)
    excel.Quit()

# 예시 실행
convert_excel_to_pdf(r"C:\docs\sample.xlsx", r"C:\docs\sample.pdf")


def convert_ppt_to_pdf(ppt_path, pdf_path):
    powerpoint = win32com.client.Dispatch("PowerPoint.Application")
    powerpoint.Visible = False

    presentation = powerpoint.Presentations.Open(ppt_path, WithWindow=False)
    presentation.SaveAs(pdf_path, 32)  # 32 = PDF
    presentation.Close()
    powerpoint.Quit()

# 예시 실행
convert_ppt_to_pdf(r"C:\docs\slide.pptx", r"C:\docs\slide.pdf")


def convert_office_to_pdf(input_path):
    ext = os.path.splitext(input_path)[1].lower()
    output_path = input_path.replace(ext, ".pdf")

    if ext in [".doc", ".docx"]:
        convert_word_to_pdf(input_path, output_path)
    elif ext in [".xls", ".xlsx"]:
        convert_excel_to_pdf(input_path, output_path)
    elif ext in [".ppt", ".pptx"]:
        convert_ppt_to_pdf(input_path, output_path)
    else:
        print(f"지원하지 않는 파일 확장자: {ext}")

# 예시 실행
convert_office_to_pdf(r"C:\docs\auto_test.docx")
