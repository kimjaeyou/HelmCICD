import win32com.client
import os

def convert_word_to_pdf(docx_path, pdf_path):
    word = win32com.client.Dispatch("Word.Application")
    word.Visible = False

    doc = word.Documents.Open(docx_path)
    doc.ExportAsFixedFormat(pdf_path, ExportFormat=17)  # 17 = PDF
    doc.Close()
    word.Quit()

# ì˜ˆì‹œ ì‹¤í–‰
convert_word_to_pdf(r"C:\docs\test.docx", r"C:\docs\test.pdf")

def convert_excel_to_pdf(xlsx_path, pdf_path):
    excel = win32com.client.Dispatch("Excel.Application")
    excel.Visible = False

    workbook = excel.Workbooks.Open(xlsx_path)
    workbook.ExportAsFixedFormat(0, pdf_path)  # 0 = PDF
    workbook.Close(False)
    excel.Quit()

# ì˜ˆì‹œ ì‹¤í–‰
convert_excel_to_pdf(r"C:\docs\sample.xlsx", r"C:\docs\sample.pdf")


def convert_ppt_to_pdf(ppt_path, pdf_path):
    powerpoint = win32com.client.Dispatch("PowerPoint.Application")
    powerpoint.Visible = False

    presentation = powerpoint.Presentations.Open(ppt_path, WithWindow=False)
    presentation.SaveAs(pdf_path, 32)  # 32 = PDF
    presentation.Close()
    powerpoint.Quit()

# ì˜ˆì‹œ ì‹¤í–‰
convert_ppt_to_pdf(r"C:\docs\slide.pptx", r"C:\docs\slide.pdf")


def convert_office_to_pdf(input_path):
    ext = os.path.splitext(input_path)[1].lower()
    output_path = input_path.replace(ext, ".pdf")

    if ext in [".doc", ".docx"]:
        convert_word_to_pdf(input_path, output_path)
    elif ext in [".xls", ".xlsx"]:
        convert_excel_to_pdf(input_path, output_path)
    elif ext in [".ppt", ".pptx"]:
        convert_ppt_to_pdf(input_path, output_path)
    else:
        print(f"ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í™•ì¥ì: {ext}")

# ì˜ˆì‹œ ì‹¤í–‰
convert_office_to_pdf(r"C:\docs\auto_test.docx")








import os
import win32com.client
from PIL import Image
from fpdf import FPDF

def convert_word_to_tiff(docx_path, tiff_path):
    word = win32com.client.Dispatch("Word.Application")
    word.Visible = False
    try:
        doc = word.Documents.Open(docx_path)
        doc.SaveAs(tiff_path, FileFormat=17)  # 17 = TIFF
        doc.Close()
    finally:
        word.Quit()

def tiff_to_pdf(tiff_path, pdf_path):
    image = Image.open(tiff_path)
    images = []
    try:
        while True:
            images.append(image.convert("RGB"))
            image.seek(image.tell() + 1)
    except EOFError:
        pass

    if images:
        images[0].save(pdf_path, save_all=True, append_images=images[1:])
    else:
        print("âŒ TIFFì—ì„œ í˜ì´ì§€ë¥¼ ì¶”ì¶œí•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.")

def convert(docx_path):
    if not os.path.exists(docx_path):
        print(f"âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {docx_path}")
        return

    base, _ = os.path.splitext(docx_path)
    tiff_path = base + ".tiff"
    pdf_path = base + "_converted.pdf"

    print("ğŸ“„ Word ë¬¸ì„œ â†’ TIFF ì´ë¯¸ì§€ ë³€í™˜ ì¤‘...")
    convert_word_to_tiff(docx_path, tiff_path)

    print("ğŸ–¼ TIFF ì´ë¯¸ì§€ â†’ PDF ë³€í™˜ ì¤‘...")
    tiff_to_pdf(tiff_path, pdf_path)

    print(f"âœ… ë³€í™˜ ì™„ë£Œ: {pdf_path}")

if __name__ == "__main__":
    # ì˜ˆì‹œ: sample.docx ê°€ ê°™ì€ í´ë”ì— ìˆë‹¤ê³  ê°€ì •
    target_file = os.path.join(os.getcwd(), "sample.docx")
    convert(target_file)
